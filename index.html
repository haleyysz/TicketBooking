<!DOCTYPE html>
<html ng-app="ticket.app">

	<head>
		<link rel="shortcut icon" type="image/x-icon" href="img/movie.ico" media="screen" />
		<!--浏览器小图标-->
		<link rel="Bookmark" href="img/movie.ico" />
		<!--收藏夹显示图标-->
		<link rel="stylesheet" href="css/stylesheet.css" />
		<script type="text/javascript" src="js/common.js"></script>
		<script type="text/javascript" src="js/bootstrap.js"></script>
		<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0/angular-route.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.0/angular-resource.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.5.0/angular-animate.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.15/angular-ui-router.min.js"></script>
		<script type="text/javascript" src="js/ui-bootstrap-tpls-2.5.0.min.js"></script>
		<title>Ticket Booking System</title>
	</head>

	<body>
		<div ng-controller="ticketController">
			<div class="header">
				<div class="top">
					<div class="top1">
						<a href="index.html">
							<img alt="brand" src="img/movie.ico" />
						</a>
						<h1><strong>Ticket Booking System</strong></h1>
					</div>
					<div class="top2">
					</div>
				</div>

				<nav class="menu navbar navbar-inverse">
					<div class="container-fluid">
						<!-- Brand and toggle get grouped for better mobile display -->
						<div class="navbar-header">
							<a class="navbar-brand" ng-click="refresh()">
								Home
								<!--<img alt="Brand" src="img/video_movie.png">-->
							</a>
						</div>

						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
							<ul class="nav navbar-nav">
								<li>
									<a href="#movie">Movie</a>
								</li>
								<li>
									<a href="#seats">Cinema</a>
								</li>
								<li>
									<a href="#buy-tickets">Ticket</a>
								</li>
							</ul>
							<form class="navbar-form navbar-right" role="search">
								<div class="form-group">
									<input type="text" style="width: 250px;" class="form-control" placeholder="Enter ticket number" ng-model="data.ticNum">
								</div>
								<button class="btn btn-default" ng-click="setStep(3)">Submit</button>
							</form>
						</div>
						<!-- /.navbar-collapse -->
					</div>
					<!-- /.container-fluid -->
				</nav>
			</div>

			<div class="main">
				<div class="content" ng-show="step==1">
					<div class="movie-bg">
						<div class="movie" id="movie">
							<div class="poster">
								<img src="img/post-S.png" />
							</div>
							<div class="info" style="margin-top: 10px;">
								<h3>Beauty and The Beast</h3>
								<div class="record">
									<p class="star">
										<span class="all-star"><img src="img/all_star.png"/></span>
										<span class="all-star"><img src="img/all_star.png"/></span>
										<span class="all-star"><img src="img/all_star.png"/></span>
										<span class="half-star"><img src="img/half_star.png"/></span>
										<span class="empty-star"><img src="img/empty_star.png"/></span>
									</p>
									<p class="rating">7.4</p>
									<p class="rating-1"> /10</p>
								</div>
								<div class="movie-detail" role="navigation">
									<p class="des ">An adaptation of the fairy tale about a monstrous-looking prince and a young woman who fall in love.</p>

									<ul class="detail-item list-inline ">
										<li class="item-title ">Director :</li>
										<li class="item-detail ">Bill Condon</li>
									</ul>
									<ul class="detail-item list-inline ">
										<li class="item-title ">Writers :</li>
										<li class="item-detail "> Stephen Chbosky (screenplay), Evan Spiliotopoulos (screenplay)..</li>
									</ul>
									<ul class="detail-item list-inline ">
										<li class="item-title ">Stars :</li>
										<li class="item-detail "> Emma Watson, Dan Stevens, Luke Evans..</li>
									</ul>
									<a type="button" class="btn btn-primary btn-lg buy-tickets " id="buy-tickets" href="#buy-tickets">
										Select <span class="glyphicon glyphicon-triangle-right " aria-hidden="true "></span>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
				<br/>

				<div class="seats " id="seats" ng-show="step==1">
					<h1>Select a cinema <span class="s-label label label-info">Now</span></h1>

					<div class="date">
						<ul class="date-item row">
							<li ng-repeat="(i,time) in times" ng-class="time.selected ? 'time_select' : 'time_default'" ng-click="selectTime(i)">{{time.date | date: 'EEEE,MMMM d,y'}}</li>
						</ul>
					</div>

					<div class="cinema container-fluid">
						<ul class="cinema-detail row">
							<li class="col-md-2 li-s">
								<p class="cinema-s1" style="color: #808080;"></p>
							</li>
							<li class="col-md-2 li-s">
								<p class="cinema-s2" style="color: #808080;">Cinema Name</p>
							</li>
							<li class="col-md-2 li-s">
								<p class="cinema-s3" style="color: #808080;">Start Time</p>
							</li>
							<li class="col-md-2 li-s">
								<p class="cinema-s4" style="color: #808080;">Available Tickets</p>
							</li>
							<li class="col-md-2 li-s">
								<p class="cinema-s5" style="color: #808080;"></p>
							</li>
							<li class="col-md-2 li-s">
								<p class="cinema-s5" style="color: #808080;"></p>
							</li>
						</ul>
						<ul class="cinema-detail row" id="cinema-detail">
							<li class="col-md-2">
								<a class="thumbnail cinema-pic ">
									<img src="img/Marcus La Crosse.jpg " alt="cinema ">
								</a>
							</li>
							<li class="col-md-2">
								<a href="https://goo.gl/maps/JkJ1Y6eQvrr" class="cinema-n" title="Marcus Cinema">Marcus Cinema</a>
							</li>
							<li class="col-md-2">
								<p class="cinema-n" style="color: #808080;">8:00 pm</p>
							</li>
							<li class="col-md-2">
								<p class="cinema-n" style="color: #808080;">{{remain}}</p>
							</li>
							<li class="col-md-2">
								<a type="button " class="btn btn-primary btn-lg " ng-click="showSeat()" title="View Seats Arrangements">
									View Seats <span class="glyphicon glyphicon-triangle-right " aria-hidden="true "></span>
								</a>
							</li>
							<li class="col-md-2">
								<a type="button " class="btn btn-primary btn-lg " ng-click="setStep(2)" title="Buy Tickets!">
									Buy Tickets <span class="glyphicon glyphicon-triangle-right " aria-hidden="true "></span>
								</a>
							</li>
						</ul>
					</div>
				</div>

				<div ng-show="step==2">
					<div class="container">
						<div class="stepwizard col-md-offset-3">
							<div class="stepwizard-row setup-panel" ng-if="!fromSeat">
								<div class="stepwizard-step">
									<a href="#step-1" type="button" ng-class="bookStep==1?'btn btn-primary btn-circle':'btn btn-default btn-circle'" ng-disabled="bookStep!=1">1</a>
									<p class="step">Tickets</p>
								</div>
								<div class="stepwizard-step">
									<a href="#step-2" type="button" ng-class="bookStep==2?'btn btn-primary btn-circle':'btn btn-default btn-circle'" ng-disabled="bookStep!=2">2</a>
									<p class="step">Payment</p>
								</div>
								<div class="stepwizard-step">
									<a href="#step-3" type="button" ng-class="bookStep==3?'btn btn-primary btn-circle':'btn btn-default btn-circle'" ng-disabled="bookStep!=3">3</a>
									<p class="step">Seats</p>
								</div>
								<div class="stepwizard-step">
									<a href="#step-4" type="button" ng-class="bookStep==4?'btn btn-primary btn-circle':'btn btn-default btn-circle'" ng-disabled="bookStep!=4">4</a>
									<p class="step">Comfirmation</p>
								</div>
							</div>
							<br />
						</div>

						<form role="form" action="" method="post">
							<div class="row setup-content" id="step-1" ng-if="bookStep==1">
								<div class="col-xs-6 col-md-offset-3">
									<div class="col-md-12">
										<div class="form-group">
											<div class="ticNum">How Many Tickets?</div>
											<br />
											<div class="row">
												<div class="input-group col-md-4" style="float: left; margin-left: 100px; padding: 0 5px 0 5px;">
													<div class="input-group-addon pointer" ng-click="setticketNum(-1)">-</div>
													<input type="text" class="form-control" id="exampleInputAmount" placeholder="Amount" ng-model="data.ticketNum" onkeyup="value=value.replace(/[^\d]/g,'') " onbeforepaste="clipboardData.setData('text',clipboardData.getData('text').replace(/[^\d]/g,''))">
													<div class="input-group-addon pointer" ng-click="setticketNum(1)">+</div>
												</div>
												<div class="ticPrice col-md-4">x $5 = ${{data.ticketNum*5}}</div>
												<div class="col-md-10 col-md-offset-2 alter alert-danger err">{{errNum}}</div>
											</div>
										</div>
									</div>
									<button class="btn btn-primary nextBtn btn-lg pull-right b-margin" type="button" ng-click="setBookStep(2)">Next</button>
								</div>
							</div>
						</form>
						<div class="row setup-content" id="step-2" ng-if="bookStep==2">
							<div class="col-xs-6 col-md-offset-3">
								<div class="col-md-12">
									<div class="visa">
										<label class="control-label fl">Use Credit or Debit Card</label>
										<div style="display: inline; margin-left: -200px;">
											<input type="radio" />
											<img src="img/visa.jpg" class="" style="width: 60px;height: 60px;" />
										</div>
									</div>
									<div class="form-group">
										<label class="control-label fl">Account Number</label>
										<input maxlength="100" type="text" class="form-control" placeholder="Enter Account Number" />
									</div>
									<div class="form-group">
										<label class="control-label fl">Full Name</label>
										<input name="u" maxlength="100" type="text" class="form-control" ng-model="data.username" placeholder="Enter Full Name" />
										<span ng-show="!data.username" class="alert-danger fl">Please Enter Your Name</span>
									</div>
									<br />
									<div class="form-group">
										<label class="control-label fl">Phone Number</label>
										<input maxlength="100" type="text" class="form-control" placeholder="Enter Phone Number" />
									</div>
									<div class="form-group">
										<label class="control-label fl">Mailing Address</label>
										<input maxlength="100" type="text" class="form-control" placeholder="Enter Mailing Address" />
									</div>
									<button class="btn btn-primary nextBtn btn-lg pull-right b-margin" type="button" ng-click="setBookStep(3)">Next</button>
								</div>
							</div>
						</div>
						<div class="row setup-content" id="step-3" ng-if="bookStep==3">
							<div class="col-xs-6 col-md-offset-2">
								<div class="col-md-12">
									<div class="ticNum col-md-offset-1" ng-if="!fromSeat">Choose Your Seats</div>
									<div>
										<div class="screen"><img src="img/screen.png" /></div>
										<div ng-repeat="(s,seat) in seats" ng-class="statusClass[seat.status]" ng-click="setTicket(s)" uib-popover-template="data.templateUrl" popover-trigger="'mouseenter'">
										</div>
									</div>
									<br />
									<div class="seat-info">
										<div class="seat-detailss"></div>
										<p class="navbar-text seat-txt" style="padding-top: 20px;">Available</p>
										<div class="seat-detailss label-danger"></div>
										<p class="navbar-text seat-txt" style="padding-top: 20px;">Unavailable</p>
										<div class="seat-detailss label-success"></div>
										<p class="navbar-text seat-txt" style="padding-top: 20px;">Selected</p>
									</div>
									<button class="btn btn-primary nextBtn btn-lg pull-right b-margin" type="button" ng-click="setBookStep(4)" ng-if="!fromSeat">Next</button>
									<button class="btn btn-primary nextBtn btn-lg pull-right b-margin" type="button" ng-click="refresh()" ng-if="fromSeat">Back</button>
								</div>
							</div>
							<div class="pull-right cardd">

								<div class="col-sm-6 col-md-12">
									<div class="card">
										<img class="card-img-top" src="img/post-S.png">
										<div class="card-block">
											<h4 class="card-title">Beauty and The Beast</h4>
											<h5 class="card-title1">Marcus LaCrosse Cinema</h5>
											<div class="meta" ng-if="!fromSeat">
												<a href="" title="{{data.username}}">{{data.username}}</a>
											</div>
											<div class="card-text" ng-if="!fromSeat">
												Tickets: {{data.ticketNum}}
											</div>
											<div class="card-text" ng-if="!fromSeat">
												{{data.seatInfo}}
											</div>
										</div>
										<div class="card-footer">
											<span class="float-right">Date: </span>
											<span><i class=""></i>8.00pm, {{selectedTime | date: 'EEEE,MMMM d,y'}}</span>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="row setup-content" id="step-4" ng-if="bookStep==4">
							<div class="col-xs-6 col-md-offset-2">
								<div class="col-md-12">
									<div class="ticNum col-md-offset-4">Tickets (Selected Seats)</div>
									<div class="ticket" ng-repeat="ticket in tickets">

										<div class="stub">
											<div class="topp">
												<span class="admit">{{ticket.id}}</span>
											</div>
											<div class="number" ng-if="ticket.position!=-1">{{seatCode(ticket.position)}}</div>
										</div>
										<div class="check">
											<div class="big">
												Beauty and The Beast
											</div>
											<div class="info">
												<section>
													<div class="title">Time</div>
													<div>8.00pm</div>
												</section>
												<section>
													<div class="title">Issued By</div>
													<div>{{ticket.username}}</div>
												</section>
												<section>
													<div class="title">Date</div>
													<div>{{selectedTime | date: 'EEEE,MMMM d,y'}}</div>
												</section>
											</div>
										</div>
									</div>

									<button class="btn btn-success btn-lg b-margin1" ng-click="saveTicket()">Submit</button>
								</div>
							</div>
						</div>

						<!--container end-->
					</div>
				</div>
				<div class="row setup-content" id="step-5" ng-show="step==3">
					<div class="col-xs-6 col-md-offset-2">
						<div class="col-md-12" ng-if="searchTicket">
							<div class="ticNum col-md-offset-4">Tickets (Selected and Unselected Seats)</div>
							<div class="ticket">
								<div class="stub">
									<div class="topp">
										<span class="admit">{{searchTicket.id}}</span>
									</div>
									<div class="number" ng-if="searchTicket.position!=-1">{{seatCode(searchTicket.position)}}</div>

								</div>
								<div class="check">
									<div class="big">
										Beauty and The Beast
									</div>
									<div class="info">
										<section>
											<div class="title">Time</div>
											<div>8.00pm</div>
										</section>
										<section>
											<div class="title">Issued By</div>
											<div>{{searchTicket.username}}</div>
										</section>
										<section>
											<div class="title">Date</div>
											<div>{{searchTicket.date | date: 'EEEE,MMMM d,y'}}</div>
										</section>
									</div>
								</div>
							</div>
						</div>
						<div class="btn btn-primary btn-lg b-margin2 col-md-offset-1 pull-right" ng-if="searchTicket.position==-1" ng-click="reSeat()">
							Select Seats
						</div>
						<div class="btn btn-primary btn-lg b-margin2 col-md-offset-1 pull-right" ng-click="getRefuns()">
							Get Refunds
						</div>
					</div>
				</div>
				<div class="row setup-content" id="step-6" ng-show="step==4">
					<div class="tip alert alert-success" role="alert">{{info}}</div>
					<h2 style="color: #5c5c60;">The system will jump to the home page automatically after 5 seconds</h2>
				</div>
			</div>

			<div class="footer ">©2017 Shizheng Yang. All Rights Reserved.</div>
		</div>
		
		<script type="text/ng-template" id="myPopoverTemplate.html">
			<div>{{seatCode(s)}}</div>
			<div class="form-group">
				<label>The seat is {{statusTostring[seat.status]}}</label>
			</div>
		</script>
		
		<script type="text/javascript">
			function guid(t) {
				function S4() {
					return(((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
				}
				return(t + "-" + S4() + "-" + S4() + S4());
			}

			/**
			 * You must include the dependency on 'ngMaterial'
			 */
			angular.module('ticket.app', ['ui.bootstrap']).controller('ticketController', function($scope, $window) {
				$scope.times = [];
				$scope.selectedTime;
				for(var i = 0; i < 8; i++) {
					var day = new Date().getTime() + 24 * 60 * 60 * 1000 * i;
					var dayitem = {
						date: day,
						selected: false
					}
					$scope.times.push(dayitem)
				}
				$scope.step = 1;
				
				$scope.tickets;
				$scope.fromSearch = false;
				$scope.fromSeat = false;
				$scope.info;
				$scope.data = {
					username: "",
					templateUrl: 'myPopoverTemplate.html',
					seatInfo: "Seats not selected",
					ticNum: "",
					ticketNum :1
				};
                $scope.refresh=function(){
                	$window.location.reload();
                	
                }
				$scope.showSeat=function(){
					$scope.step = 2;
					$scope.bookStep = 3;
					$scope.creatSeat();
					$scope.fromSeat=true;
				}
				
				$scope.setticketNum = function(num) {
					$scope.data.ticketNum = parseInt($scope.data.ticketNum)
					num = parseInt(num);
					var tickets = localStorage.getItem($scope.getNormalizedTime($scope.selectedTime))
					var re = 60;
					if(tickets) {
						re = 60 - JSON.parse(tickets).length;
					}
					if($scope.data.ticketNum + num > 0 && re>=$scope.data.ticketNum + num) {
						$scope.data.ticketNum += num;
					}
				}

				$scope.seatCode = function(index) {
					return String.fromCharCode(index / 6 + 65) + "" + (index % 6 + 1)
				}

				$scope.creatSeat = function() {
					$scope.seats = [];
					for(var i = 0; i < 60; i++) {
						$scope.seats.push({
							status: 0
						})
					}

					var tickets = localStorage.getItem($scope.getNormalizedTime($scope.selectedTime));
					if(tickets) {
						tickets = JSON.parse(tickets);
						console.log(tickets + $scope.selectedTime)
						for(var j = 0; j < tickets.length; j++) {
							var ticket = tickets[j];

							if(ticket.position != -1) {
								$scope.seats[ticket.position].status = 2;
							}
						}
					}
				}
				$scope.showSeat=function(){
					$scope.step = 2;
					$scope.bookStep = 3;
					$scope.creatSeat();
					$scope.fromSeat=true;
				}
				$scope.searchTicket;
				$scope.searchTicketIndex = -1;
				$scope.searchTicketKey;
				$scope.setStep = function(s) {
					if(s == 3) {
						if(!$scope.data.ticNum) {
							return;
						}
						var arr = $scope.data.ticNum.split("-");
						if(arr.length > 0) {
							var timeStamp = arr[0];
							var key = $scope.getNormalizedTime(timeStamp);
							$scope.searchTicketKey = key;
							var ts = localStorage.getItem(key)
							console.log(ts)
							if(ts) {
								ts = JSON.parse(ts);
								for(var i = 0; i < ts.length; i++) {
									if(ts[i].id == $scope.data.ticNum) {
										$scope.searchTicket = ts[i];
										$scope.searchTicketIndex = i;
										break;
									}
								}
							}
						}
					}
					$scope.step = s;
					if(s == 2) {
						$scope.creatSeat()
					}
				}

				$scope.selectTime = function(j) {
					for(var i = 0; i < 8; i++) {
						$scope.times[i].selected = false;
					}
					$scope.times[j].selected = true;
					$scope.selectedTime = $scope.times[j].date;
					var tickets = localStorage.getItem($scope.getNormalizedTime($scope.selectedTime))
					$scope.remain = 60;
					if(tickets) {
						$scope.remain = 60 - JSON.parse(tickets).length;
					}
				}

				$scope.bookStep = 1;
				$scope.setBookStep = function(s) {
					if(s == 3) {
						if(!$scope.data.username)
							return
					}
					if(s==2){
						var re = 60;
						var tickets = localStorage.getItem($scope.getNormalizedTime($scope.selectedTime))
					if(tickets) {
						re = 60 - JSON.parse(tickets).length;
					}
					
					$scope.errNum="";
					if($scope.data.ticketNum > re) {
						$scope.errNum="Error! The number of tickets is unavailable."
						return;
					}
					}
					$scope.bookStep = s;
					if(s == 4) {
						//          	$scope.tickets=localStorage.getItem($scope.getNormalizedTime($scope.selectedTime));
						//         	if(!$scope.tickets){
						$scope.tickets = [];
						//          	}else{
						//          		$scope.tickets=JSON.parse($scope.tickets)
						//          	}
						if($scope.fromSearch) {
							for(var i = 0; i < $scope.seats.length; i++) {
								if($scope.seats[i].status == 1) {
									$scope.searchTicket.position = i;
								}
							}
							$scope.tickets.push($scope.searchTicket)
						} else {

							for(var i = 0; i < $scope.seats.length; i++) {
								if($scope.seats[i].status == 1) {

									$scope.tickets.push({
										username: $scope.data.username,
										position: i,
										date: $scope.selectedTime,
										id: guid($scope.selectedTime)
									});
								}
							}

							for(var j = 0; j < $scope.data.ticketNum; j++) {
								$scope.tickets.push({
									username: $scope.data.username,
									date: $scope.selectedTime,
									id: guid($scope.selectedTime),
									position: -1
								});
							}
						}
					}
				}

				$scope.statusClass = ["seat-details", "seat-details label-success", "seat-details label-danger"];

				$scope.setTicket = function(s) {
                   if(!$scope.fromSeat){
					if($scope.seats[s].status != 2) {
						if($scope.seats[s].status == 1) {
							$scope.seats[s].status = 0;
							$scope.data.ticketNum++;
						} else {
							if($scope.data.ticketNum > 0) {
								$scope.data.ticketNum--;
								$scope.seats[s].status = 1;
							}
						}
						$scope.setSeatInfo();
					}
}
				}

				$scope.setSeatInfo = function() {
					var info = "";
					for(var i = 0; i < $scope.seats.length; i++) {
						if($scope.seats[i].status == 1) {
							info += $scope.seatCode(i) + ",";

						}
					}
					$scope.data.seatInfo = info ? "Seats：" + info.substr(0, info.length - 1) : "Seats not selected";
				}

				$scope.saveTicket = function() {
					if($scope.fromSearch) {
						$scope.getRefuns();

					}
					var tickets = localStorage.getItem($scope.getNormalizedTime($scope.selectedTime));
					if(!tickets) {
						tickets = $scope.tickets;
					} else {

						tickets = JSON.parse(tickets);

						for(var i = 0; i < $scope.tickets.length; i++) {
							tickets.push($scope.tickets[i]);
						}
					}
					localStorage.setItem($scope.getNormalizedTime($scope.selectedTime), JSON.stringify(tickets));
					if($scope.fromSearch) {
						$scope.fromSearch = false;
						$scope.showInfo("Congratulations! Select seat successfully!");
					} else {
						$scope.showInfo("Congratulations! Buy tickets successfully!");
					}
				}
				$scope.statusTostring = ["Available", "Selected", "Unavailable"]
				$scope.showInfo = function(info) {
					$scope.step = 4;
					$scope.info = info;
					setTimeout("javascript:window.location.reload()", 5000);

				}
				$scope.reSeat = function() {
					$scope.step = 2;
					$scope.bookStep = 3;
					$scope.selectedTime = $scope.searchTicket.date;
					$scope.fromSearch = true;
					$scope.creatSeat();
				}

				$scope.getRefuns = function() {
					var ts = localStorage.getItem($scope.searchTicketKey)
					console.log(ts)
					if(ts) {
						ts = JSON.parse(ts);
						ts.splice($scope.searchTicketIndex, 1);
						localStorage.setItem($scope.searchTicketKey, JSON.stringify(ts));
					}
					$scope.showInfo("Congratulations! Get full refund successfully!");
				}

				// 0-未选 1-已选 2-不可选
				$scope.getNormalizedTime = function(time) {
					var date = new Date();
					date.setTime(time);
					return date.toDateString();
				}
				$scope.selectTime(0);
			});
		</script>
	</body>

</html>